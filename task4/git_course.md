# Основы Git

---

## Введение

### Что такое Git?

**Git** - это система контроля версий. По-другому это хранилище для истории разработки проекта, которая содержит все версии его файлов, как текущие, так и старые, уже не актуальные.

### Как работает Git

В процессе разработки проекта мы добаляем в Git начальные версии наших файлов. Потом, когда мы что-то изменили, мы добавляем в Git обновленную версию файлов, и Git также сохраняет ее у себя.
Мы всегда можем посмтреть хранилище и при необходимости восстановить предыдущие версии файлов.

### Командная разработка

Git может не только хранить версии, но и позволяет обмениваться ими между разработчиками. В отличие от простого копирования, в Git есть встроенные средства обнаружения конфликтов и интеграции изменений.

---

## Основы кофигурации Git

### Настройка конфига

```bash
git config user.name '[имя]'
git config user.email '[почта]'
```

### Уровни настроек

- `--system` - устанавливает настройки на уровне системы
- `--global` - устанавливает настройки на уровне пользователя
- `--local` - устанавливает настройки на уровне проекта

### Просмотр настроек

```bash
git config [уровень настройки] --list
```

### Удаление настроек

```bash
git config --unset user.name
git config --unset user.email
```

или можно удалить сразу оба параметра

```bash
git config --remove-section user
```

### Установка текстового редактора

```bash
git config --global core.editor '[путь/до/исполняемого/файла]'
```

### Псевдонимы (alias)

Сократим команду `git config` до `git c`

```bash
git config --global alias.c config
```

Теперь можно ее использовать как обычную команду

```bash
git c --list
```

### Вывод подсказки

```bash
git help [команда]
```

При вызове данной команды откроется списко всевозможных параметров и флагов для работы с командой.
Весь список открывается в Less, чтобы управлять им потребуется 4 базовых команды:

- `/[поиск]` - поиск введенного слова в списке
- `n` - пролистать вперед
- `Shift + n` - пролистать назад
- `q` - выход

---

## Создание репозитория

### Создание пустого репозитория

```bash
git init
```

В корне проекта создастся директория `.git/`, в которой будет содержаться база данных git и его основные настройки.

### Добавление файлов в индекс

```bash
git add [имя файла]
```

или же можно использовать `.` для добавления всех не проиндексированных файлов в текущей директории, а также `-A` для добавления всех файлов из корневой директории.

### Создание коммита

```bash
git commit -m '[имя коммита]'
```

Коммит хранит в себе информацию о добавленных изменениях в проекте и данные о том, кто создал его и в какое время.

### Смена ветки

```bash
git branch -M main
```

### Связывание локального репозитория с удаленным репозиторием на GitHub

```bash
git remote add origin [ссылка на репозиторий]
```

### Обновление изменений

```bash
git push -u origin main
```

---

## Права на файлы

При создании коммита, например, вот такого `git commit -m 'first commit'` в консоль будет выведено подобное сообщение:

```
1 file changed, 1 insertions(+)
create mode 100644 [имя файла]
```

Перед именем добавленного файла стоит число `100644`. Первая половина этого числа (`100`) означает тип добавленного объекта, в нашем случае это файл. Вторая половина (`644`) означает права на этот файл, но в зависимости от ОС права могут быть разными.
Например, `644` - не исполнимый файл, `755` - исполнимый.

Для Git изменения права на выполнение существенно на равне с изменением в содержимом файла.

Обычно файловые системы под Windows не поддерживают отдельное право на выполнение файла, в отличие от Unix систем. В Windows правом на выполнение объеденино с право на чтение. Поэтому при создании репозитория Git устанавливает настройку `git config core.fileMode false`, если Windows система.

---

## Просмотр коммита

```bash
git show [идентификатор коммита]
```

Коммит содержит добавленные в него данные, а также данные о коммиттере и о самом авторе коммита.

```bash
git commit --author='[имя автора] <почта автора>' --date='дата'
git commit --committer='[имя коммиттера] <почта коммиттера>' --date='дата'
```

---

## Добавление файлов и директорий

### Проверка текущего состояния репозитория

```bash
git status
```

Выводит в консоль информацию об отслеживаемых файлах, а также о не добавленных в индекс файлов и директориях.

Git не работает с пустыми директориями, поэтому, если вы создадите пустую директорию, то не увидите ее через команду `git status`. Обычно, чтобы это обойти это ограничение, в директорию кладут вспомогательный файл нулевого размера - `.gitkeep`.

### Добавление файлов в индекс

```bash
git add .
```

Добавляет все изменения в Git из текущего каталога.

```bash
git add -A
```

Добавляет все изменения в Git из корневого каталога проекта.

```bash
git add -f [имя файла/директории]
```

Добавляет изменения из файлов и директории указаных в `.gitignore`.

### Игнорируемые файлы и директории

Для того чтобы пометить файлы и директории, которые не нужно добавлять в Git, необходимо в корне проекта создать файл `.gitignore` и указать в нём имена всех файлов и директорий, которые не должны отслеживаться Git.


```bash
git reset HEAD [имя файла/директории]
```

Если вы уже добавили какой-то файл или директорию и хотите его убрать из индекса.

---

## Правила создания коммитов

### Атомарность коммитов

Не следует коммить всё подряд. Каждое исправление или новая фича - это отдельный коммит.

### Понятность и краткость

Сообщение должно описывать, что именно изменилось, например:

```
fix: fixed button display bug
feat: added authorization option
```

Примеры типов:

- `feat:` - новая фича
- `fix:` - исправление бага
- `refactor:` - улучшение кода
- `style:` - исправление стилей
- `test:` - добавление/обновление тестов

### Добавление описания

Если коммит получился слишком большим и содержит много изменений, то после заголовка в описании коммита через двойной перевод строки указывают детали.

---

## Предназначение индекса

Индекс в Git служит промежуточным состоянием между рабочим каталогом и репозиторием. Он позволяет выборочно добавлять изменения перед коммитом, предоставляя более точный контроль над тем, что будет включено в каждый коммит.

```bash
git add -p [имя файла]
```

Git предложит выбрать нужные изменения для добавления его в коммит. Основные варианты:

- `y` - добавить изменение
- `n` - не добавлять изменение
- `q` - выход
- `?` - отобразит подсказку

## Коммиты без git add

```bash
git commit -am '[имя коммита]'
```

Добавляет изменения в отслеживаемых файлах в индекс и сразу же создает коммит.

```bash
git commit -m '[имя коммита]' [имя файла]
```

Добавляет изменения из указанного файла (если он уже отслеживается) и коммитит его.

```bash
git config --global alias.commitall '!git add .; git commit'
git commitall -m [имя коммита]
```

Создаёт alias `commitall`, который добавляет все изменения в индекс и сразу выполняет коммит.

---

## Удаление и переименование файлов

### Удаление файлов

```bash
git rm [имя файла]
git rm -r [имя директории]
```

Удаляет файл или директорию из рабочей директории и добавляет изменения в индекс.

```bash
git rm --cached [имя файла]
git rm -r --cached [имя директории]
```

Удаляет файл или директорию из индекса, но оставляет его в рабочем каталоге.

```bash
git rm -f [имя файла]
```

Флаг `-f` позволяет принудительно удалить файл из рабочей директории и индекса, даже если несохраненные изменения не были добавлены в репозиторий.

### Переименование файлов

С точки зрения Git переименования вообще не существует. Переименование Git воспринимает как совокупность двух операций: удаление старого файла и создание нового.

```bash
git mv [старое имя файла] [новое имя файла]
```

Переименовывает файл и сразу добавляет изменения в индекс.
